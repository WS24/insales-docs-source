# Вводная

!!! info

    Шаблоны 4 поколения состоят из **виджетов**. Виджеты - это настраиваемые через редактор блоки с контентом. Для добавления виджета в шаблон нужно создать папку с названием виджета, внутри папки лежат файлы, прописанные в структуре виджета. 


#### Структура виджета

- <a href="/4%20поколение/Виджеты/snippet.liquid/">Сниппет</a>  `snippet.liquid`
- <a href="/4%20поколение/Виджеты/snippet.scss/">SCSS</a>  `snippet.scss`
- <a href="/4%20поколение/Виджеты/snippet.js/">JS</a>  `snippet.js`
- <a href="/4%20поколение/Виджеты/messages/">Переводы</a> `messages.json`
- <a href="/4%20поколение/Виджеты/settings_form/">Форма настроек</a>  `settings_form.json`
- <a href="/4%20поколение/Виджеты/settings_data/">Настройки по умолчанию</a>  `settings_data.json`
- <a href="/4%20поколение/Виджеты/setup/">Блоки по умолчанию</a>  `setup.json`
- <a href="/4%20поколение/Виджеты/preview/">Превью</a>  `preview.jpg` и `mobile_preview.jpg`
- <a href="/4%20поколение/Виджеты/info/">Метаданные</a>  `info.json`

#### Как создать пользовательский виджет?

Существует два способа создания виджета:

1. Через панель администратора
2. Добавить папку с виджетом в архив шаблона

Примеры можно посмотреть <a href="/4%20поколение/Виджеты/snippet.liquid/">здесь</a>.

#### Через панель администратора

Заходим в раздел `Настройки -> Виджеты`

Там доступно 2 варианта: создать с нуля или импортировать уже готовый виджет.

При создании нужно будет выбрать тему, к которой привяжется виджет.

#### При загрузке шаблона

Как говорилось ранее, все виджеты шаблона хранятся в папке `widget_types`. Для создания пользовательского виджета нужно добавить подпапку с названием виджета и его файлами.

Имя папки виджета должно совпадать с полем `handle` в файле <a href="/4%20поколение/Виджеты/info/#handle">info.json</a>.

Запрещено указывать названия с префиксом `system_`.

#### Добавление

Добавить виджет можно 2 способами:

1. Через <a href="/4%20поколение/Шаблон/setup.json/">setup.json</a>
2. Через интерфейс визуального редактора сайта

В первом случае виджет будет установлен по умолчанию при загрузке шаблона. Во втором случае, его можно будет добавить уже после установки.

#### setup.json

Фрагмент, в котором мы добавили виджет с пермалинком `system_widget_v4_promo_slider_4` к <a href="/4%20поколение/Виджеты/#ListWidgetInfo">виджет-листу</a> `index-list`.

```json
"theme_widgets":{
  "widget_lists":[
    {
      "name":"index",
      "handle":"index-list",
      "kind":"content",
      "widgets": [
        {
          "settings_data":{
            "hide-mobile":false,
            "hide-desktop":false,
            "img-ratio":"3",
            "autoplay":false,
            "autoplay-delay":"5"
          },
          "widget_type":"system_widget_v4_promo_slider_4",
          "data_handle":"block-list-slider"
        }
      ]
    }
  ]
}
```
<a name="ListWidgetInfo"></a> 
!!! info

    Виджет-листы требуются для разделения списков на области и страницы.
    Так как виджет-лист главной должен отличаться от виджет-листа каталога, то на каждой странице необходимо отделить виджеты основного контента от виджетов футера/сайдбара/хедера.
#### Виджет-листы   
![](/img/info2.svg)

#### Редактор сайта
Для добавления виджета на текущую страницу достаточно нажать на кнопку `+` в области редактирования или `добавить виджет` в боковой панели. После чего появится модальное окно с галереей доступных виджетов. 

Разместив виджет на сайте, он автоматически запишется в <a href="/4%20поколение/Шаблон/setup.json/">setup.json</a> при скачивании архива шаблона.

#### Вывод на сайт

Виджет-листы доступны в переменной `widget_lists`.

Пример вывода виджетов из виджет-листа `index-list`:

```liquid
{% for widgetDrop in widget_lists.index-list.widgets %}
  {% widget widgetDrop %}
{% endfor %}
```

Стили и скрипты виджетов выводятся отдельным тегом `widgets_assets`, в качестве параметра указываются названия виджет-листов через запятую.

```liquid
{% widgets_assets "header-list, footer-list, index-list" %}
```
